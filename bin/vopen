#!/bin/bash
# vopen - Open repository in browser
#
# Unified wrapper for opening the remote repository in a web browser.
# Uses git-open to open GitHub/GitLab/etc pages.
#
# Usage:
#   vopen [branch]
#
# Examples:
#   vopen              # open current branch in browser
#   vopen main         # open main branch in browser
#   vopen feature/foo  # open specific branch

[[ "$1" == "--describe" ]] && echo "Open repository in browser" && exit 0

if [[ "$1" == "--help" ]]; then
    echo "Usage: vopen [branch]"
    echo ""
    echo "Open repository in browser."
    echo "  branch   Branch to open (default: current branch or main for jj)"
    exit 0
fi

vcs_info=$(vdetect) || exit 1
vcs="${vcs_info%% *}"
vcs_root="${vcs_info#* }"

if [[ "$vcs" == "jj" ]]; then
    branch="${1:-main}"
    git -C "$vcs_root" open origin "$branch"
    exit 0
fi

if [[ -n "$1" ]]; then
    git open origin "$1"
else
    git open
fi
