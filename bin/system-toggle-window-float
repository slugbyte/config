#!/bin/bash
# $ system-toggle-floast [width height]
width=${1:-1300}
height=${2:-900}

active=$(hyprctl activewindow -j)
pinned=$(echo "$active" | jq ".pinned")
floating=$(echo "$active" | jq ".floating")
addr=$(echo "$active" | jq -r ".address")

if [[ $floating == "true" ]];then
  if [[ $pinned == "true" ]]; then
    hyprctl --quiet --batch \
      "dispatch pin address:$addr;" \
      "dispatch togglefloating address:$addr"
  else 
    hyprctl dispatch togglefloating "address:$addr"
  fi
else 
  if [[ $pinned == "true" ]]; then
    hyprctl --quiet --batch \
    "dispatch togglefloating;" \
    "dispatch resizeactive exact $width $height address:$addr;" \
    "dispatch centerwindow;"
  else 
    hyprctl --quiet --batch \
    "dispatch pin address:$addr;" \
    "dispatch togglefloating address:$addr;" \
    "dispatch resizeactive exact $width $height address:$addr;" \
    "dispatch centerwindow address:$addr;"
  fi
fi
